# 预测轨迹优化

## 运动学优化

轨迹预测的一般做法是使用网络直接输出未来轨迹的坐标(x, y), 速度加速度朝向等信息再通过坐标计算得到。

这样由模型直接输出的轨迹无法保证轨迹的运动学可行性，速度加速度朝向都可能出现不可能出现的值。

运动学优化方法 是在原来模型的最后一层和输出层之间增加一层， 输出车辆的加速度和转向角，利用加速度和转向角按照规则
计算出轨迹，损失函数不变，依旧计算预测得到的轨迹和真实轨迹之间的误差。

使用模型的时候，推理得到转向角和加速度之后，利用同样的公式推演出轨迹使用。

参考论文：

Deep Kinematic Models for Kinematically Feasible Vehicle Trajectory Predictions

## 时序一致性优化

主流的预测模型都没有考虑到前后相邻帧预测轨迹线的跳变问题，这里增加一个loss在一定程度上抑制跳变问题

loss计算前后两帧同样时刻的轨迹点的偏移量，偏移量越大loss越大